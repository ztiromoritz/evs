<!doctype html>

<html lang="en">
<head>
    <meta charset="utf-8">

    <title>Event Source Simulator</title>
    <meta name="description" content="Event Source Simulator">
    <meta name="author" content="Moritz Rebbert">

    <link rel="stylesheet" href="css/styles.css">
</head>

<body>
<div class="wrapper">
    <div id="commands">Commands</div>
    <div id="events">
        <div class="event currentEvent ">
            Event 1
        </div>

        <div class="event">
            Event 2
        </div>


    </div>
    <div id="state">State:<pre>{balance: 0}</pre></div>
    <div id="controls"><button>Next</button><button>Run</button><button>Foo</button> </div>
    <div id="editor">
        (function(){
        return {
        onCommand : (command)=>{

        },
        onEvent : (event)=>{

        },
        };
        })();</div>
    <div id="view">View</div>
</div>


<script src="js/index.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.9/ace.js"></script>
<script>
    var editor = ace.edit("editor");
    editor.setTheme("ace/theme/monokai");
    editor.getSession().setMode("ace/mode/javascript");
    var actor = eval(editor.getValue());
</script>

<script>

    document.addEventListener('click', function(e){
        console.log(e);



        var newEvent = document.createElement('div');
        newEvent.classList.add('event');
        newEvent.classList.add('invisible');

        document.querySelector('#events').appendChild(newEvent);

        var clientRect = newEvent.getBoundingClientRect();
        console.log(clientRect);

        var shadow = document.createElement('div');
        shadow.classList.add('event');
        shadow.classList.add('shadow');

        var style = `width: ${clientRect.width}px; height: ${clientRect.height}px; top: ${e.pageY}px; left: ${e.pageX}px;`;
        shadow.style = style;

        document.body.appendChild(shadow);
        shadow.addEventListener("transitionend", function(e){
            if(shadow.parentNode){//fires for every property

                newEvent.classList.remove('invisible');
                document.body.removeChild(shadow);
            }
        }, false);
        setTimeout(function(){
            shadow.style = `width: ${clientRect.width}px; height: ${clientRect.height}px; top: ${clientRect.top}px; left: ${clientRect.left}px;`;
        },0);
    });

</script>

</body>
</html>